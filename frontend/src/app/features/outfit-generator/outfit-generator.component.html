<div class="outfit-generator-container">
  <!-- Header -->
  <div class="header">
    <div class="title-section">
      <mat-icon class="main-icon">checkroom</mat-icon>
      <h1>LazyCloset</h1>
      <p>Mix & Match Your Perfect Outfit</p>
    </div>
    
    <div class="action-buttons">
      <button mat-fab color="primary" (click)="openUploadModal()" class="upload-fab">
        <mat-icon>add</mat-icon>
      </button>
      
      <div class="outfit-controls">
        <button mat-raised-button color="accent" (click)="generateRandomOutfit()">
          <mat-icon>shuffle</mat-icon>
          Random Outfit
        </button>
        <button mat-button (click)="clearOutfit()">
          <mat-icon>clear</mat-icon>
          Clear
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>Loading your closet...</p>
  </div>

  <!-- Main Outfit Display -->
  <div *ngIf="!isLoading" class="outfit-display-area">
    
    <!-- Outfit Mannequin -->
    <div class="outfit-mannequin">
      
      <!-- Hat Layer -->
      <div class="outfit-item hat-item" 
           *ngIf="getLayer('hat') && getCurrentItem(getLayer('hat')!) as hatItem"
           [style.z-index]="5"
           cdkDrag
           cdkDragBoundary=".outfit-mannequin"
           (cdkDragStarted)="onDragStarted()"
           (cdkDragEnded)="onDragEnded()"
           (cdkDragDropped)="onDragDropped($event)">
        <img [src]="hatItem.thumbnailUrl || hatItem.imageUrl" 
             [alt]="hatItem.originalFileName"
             class="item-image">
        <div class="drag-handle">
          <mat-icon>drag_indicator</mat-icon>
        </div>
      </div>
      
      <!-- Top Layer -->
      <div class="outfit-item top-item" 
           *ngIf="getLayer('top') && getCurrentItem(getLayer('top')!) as topItem"
           [style.z-index]="4"
           cdkDrag
           cdkDragBoundary=".outfit-mannequin"
           (cdkDragStarted)="onDragStarted()"
           (cdkDragEnded)="onDragEnded()"
           (cdkDragDropped)="onDragDropped($event)">
        <img [src]="topItem.thumbnailUrl || topItem.imageUrl" 
             [alt]="topItem.originalFileName"
             class="item-image">
        <div class="drag-handle">
          <mat-icon>drag_indicator</mat-icon>
        </div>
      </div>
      
      <!-- Jacket Layer (behind top) -->
      <div class="outfit-item jacket-item" 
           *ngIf="getLayer('jacket') && getCurrentItem(getLayer('jacket')!) as jacketItem"
           [style.z-index]="3"
           cdkDrag
           cdkDragBoundary=".outfit-mannequin"
           (cdkDragStarted)="onDragStarted()"
           (cdkDragEnded)="onDragEnded()"
           (cdkDragDropped)="onDragDropped($event)">
        <img [src]="jacketItem.thumbnailUrl || jacketItem.imageUrl" 
             [alt]="jacketItem.originalFileName"
             class="item-image">
        <div class="drag-handle">
          <mat-icon>drag_indicator</mat-icon>
        </div>
      </div>
      
      <!-- Jeans Layer -->
      <div class="outfit-item jeans-item" 
           *ngIf="getLayer('jeans') && getCurrentItem(getLayer('jeans')!) as jeansItem"
           [style.z-index]="2"
           cdkDrag
           cdkDragBoundary=".outfit-mannequin"
           (cdkDragStarted)="onDragStarted()"
           (cdkDragEnded)="onDragEnded()"
           (cdkDragDropped)="onDragDropped($event)">
        <img [src]="jeansItem.thumbnailUrl || jeansItem.imageUrl" 
             [alt]="jeansItem.originalFileName"
             class="item-image">
        <div class="drag-handle">
          <mat-icon>drag_indicator</mat-icon>
        </div>
      </div>
      
      <!-- Shoes Layer -->
      <div class="outfit-item shoes-item" 
           *ngIf="getLayer('shoes') && getCurrentItem(getLayer('shoes')!) as shoesItem"
           [style.z-index]="1"
           cdkDrag
           cdkDragBoundary=".outfit-mannequin"
           (cdkDragStarted)="onDragStarted()"
           (cdkDragEnded)="onDragEnded()"
           (cdkDragDropped)="onDragDropped($event)">
        <img [src]="shoesItem.thumbnailUrl || shoesItem.imageUrl" 
             [alt]="shoesItem.originalFileName"
             class="item-image">
        <div class="drag-handle">
          <mat-icon>drag_indicator</mat-icon>
        </div>
      </div>
      
    </div>
    
    <!-- Side Controls -->
    <div class="side-controls">
      <div class="control-group" *ngFor="let layer of outfitLayers">
        <div class="category-label">{{ layer.displayName }}</div>
        <div class="navigation-controls" *ngIf="hasItems(layer)">
          <button mat-icon-button 
                  class="nav-btn"
                  (click)="previousItem(getLayerIndex(layer.category))"
                  [disabled]="!hasItems(layer)">
            <mat-icon>keyboard_arrow_up</mat-icon>
          </button>
          <span class="counter">{{ getLayerInfo(getLayerIndex(layer.category)) }}</span>
          <button mat-icon-button 
                  class="nav-btn"
                  (click)="nextItem(getLayerIndex(layer.category))"
                  [disabled]="!hasItems(layer)">
            <mat-icon>keyboard_arrow_down</mat-icon>
          </button>
        </div>
        <div class="no-items" *ngIf="!hasItems(layer)">
          <span>No items</span>
        </div>
      </div>
    </div>
    
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && !hasAnyItems()" class="empty-state">
    <mat-icon class="empty-icon">inventory_2</mat-icon>
    <h2>Your closet is empty</h2>
    <p>Start building your virtual wardrobe by adding your first clothing item!</p>
    <button mat-raised-button color="primary" (click)="openUploadModal()">
      <mat-icon>add</mat-icon>
      Add First Item
    </button>
  </div>
</div> 